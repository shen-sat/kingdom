pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
  game = {}
  run_level()
end

function _update() game.update() end

function _draw() game.draw() end

function run_level()
  ground_y = 128 - 32
  camera_x = 0
  map_start_x = 0
  map_end_x = 256
  coin_score = 0
  coins = {}
  
  player = {
   sprite = 0,
   x = 20,
   y = ground_y - 8,
   width = 8,
   height = 8,
   center_x = function(self)
    return self.x + self.width/2
   end
  }

  coin = {
   sprite = 5,
   x = 64,
   y = ground_y - 8,
   width = 8,
   height = 8
  }
  coin_two = {
   sprite = 5,
   x = 50,
   y = ground_y - 8,
   width = 8,
   height = 8
  }
  coin_three = {
   sprite = 5,
   x = 72,
   y = ground_y - 8,
   width = 8,
   height = 8
  }
  add(coins,coin)
  add(coins,coin_two)
  add(coins,coin_three)

  cam = {
   x = 0,
   width = 128
  } 

  game.update = level_update
  game.draw = level_draw
end

function level_update()
 --player
 if btn(0) then player.x -= 1 end
 if btn(1) then player.x += 1 end
 if btn(2) then player.y -= 1 end
 if btn(3) then player.y += 1 end
 manage_out_of_bounds(player)
 --camera
 cam.x = player.x - 64 + (player.width/2)
 manage_out_of_bounds(cam)
 camera(cam.x,0)

 for c in all(coins) do
  if player:center_x() > c.x and player:center_x() < (c.x + c.width) then 
   del(coins,c)
   coin_score +=1
  end 
 end
 
end

function level_draw()
 cls()
 map(0,0)
 print('coins:'..coin_score, player.x - 5, player.y - 10)
 for c in all(coins) do
  spr(c.sprite,c.x,c.y)
 end
 spr(player.sprite,player.x,player.y)
end

function manage_out_of_bounds(obj)
 if obj.x < map_start_x then obj.x = map_start_x end
 if obj.x + obj.width > map_end_x then obj.x = (map_end_x - obj.width) end 
end

__gfx__
1a1a919133333333cccccccc00010100071331000044440000000000000000000000000000000000000000000000000000000000000000000000000000000000
1aaa999133333333cccccccc00161610017333100477fa2000000000000000000000000000000000000000000000000000000000000000000000000000000000
1999999133333333cccccccc001616101333333147f99af200000000000000000000000000000000000000000000000000000000000000000000000000000000
1444442133333333cccccccc00161610144444214f9999a200000000000000000000000000000000000000000000000000000000000000000000000000000000
1441441133333333cccccccc01166161144144114a9999a200000000000000000000000000000000000000000000000000000000000000000000000000000000
1444442133333333cccccccc16666661144444214fa99a7200000000000000000000000000000000000000000000000000000000000000000000000000000000
1444422133333333cccccccc1666dd101444422104aa772000000000000000000000000000000000000000000000000000000000000000000000000000000000
0141121033333333cccccccc161d1610014112100044220000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020201020201020202020202020202020202010202010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
